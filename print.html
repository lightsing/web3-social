<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Web3 Social Deisgn Book</title>
        <meta name="robots" content="noindex" />


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="terminology.html"><strong aria-hidden="true">2.</strong> Terminology</a></li><li class="chapter-item expanded "><a href="cryptography-design.html"><strong aria-hidden="true">3.</strong> Cryptography Design</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="crypto/signature.html"><strong aria-hidden="true">3.1.</strong> Signature</a></li><li class="chapter-item expanded "><a href="crypto/encryption.html"><strong aria-hidden="true">3.2.</strong> Encryption</a></li></ol></li><li class="chapter-item expanded "><a href="message-format.html"><strong aria-hidden="true">4.</strong> Message Format</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Web3 Social Deisgn Book</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<blockquote>
<p>The key words &quot;MUST&quot;, &quot;MUST NOT&quot;, &quot;REQUIRED&quot;, &quot;SHALL&quot;, &quot;SHALL NOT&quot;, &quot;SHOULD&quot;, &quot;SHOULD NOT&quot;, &quot;RECOMMENDED&quot;, &quot;NOT RECOMMENDED&quot;, &quot;MAY&quot;, and &quot;OPTIONAL&quot; in this document are to be interpreted as described in RFC 2119 and RFC 8174.</p>
</blockquote>
<p>This project is aimed for web3 social protocol standard.</p>
<h2 id="quick-qa"><a class="header" href="#quick-qa">Quick Q&amp;A</a></h2>
<ol>
<li>
<p>Why build social network with web3 and Ethereum?</p>
<p>Building a social network with web3 and Ethereum can provide a number of benefits compared to building a traditional, centralized social network. One of the main benefits is that it can be decentralized, which means that it is not controlled by any single entity and can operate on a global, peer-to-peer basis. This can make it more resistant to censorship and other forms of interference, as well as making it more secure and resilient.</p>
<p>In addition, using Ethereum and web3 allows the social network to take advantage of the <strong>robust infrastructure and security features</strong> that are built into the Ethereum platform. This can help to address issues such as <strong>synchronization and spam</strong>, as these are issues that have already been addressed by the Ethereum team and community.</p>
</li>
<li>
<p>Do users have to have a wallet to use this protocol?</p>
<p>Yes, users will <strong>typically</strong> need a wallet to interact with a social network that is built using web3 and Ethereum. This is because transactions on the Ethereum network, including those related to the social network, require users to have an Ethereum wallet in order to sign and send transactions. </p>
<p>However, it is possible for users to <strong>delegate their operations to a service provider</strong>, who can act on their behalf and potentially use other payment methods to cover the costs of transactions. This can make it easier for users who are not familiar with Ethereum or who do not want to manage their own wallet to still use the social network.</p>
</li>
<li>
<p>What if the service provider will censor the content?</p>
<p>If a service provider begins to censor content, users have several options for responding. It's easy to migrate their identity contract to a different service provider as the identity contract is typically designed to be upgradable and can be easily migrate from one to another.</p>
<p>Another option is for users to interact with the contract directly, rather than going through a service provider. This can give them more control over their content and can help to prevent censorship, as the <strong>contract itself is always controlled by yourself</strong>.</p>
<p>It is also possible to have a <strong>SaaS platform</strong> that offers on-click deployment of service providers, allowing users to quickly and easily set up and run their own provider that they trust and will not censor their content.</p>
</li>
<li>
<p>On-chain storage is expensive, where do users' data store?</p>
<p><strong>Only</strong> metadata is stored in contract storage. The actual content of the data, such as a text post or a photo, is emitted as an event on the blockchain, and is not stored directly on the chain.</p>
<p>To further save on storage costs, the content of the data is often stored using a URL-like format, such as &quot;ipfs://&quot;, which points to the location of the data on a decentralized storage platform such as InterPlanetary File System (IPFS).</p>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="terminology"><a class="header" href="#terminology">Terminology</a></h1>
<h2 id="social-identity"><a class="header" href="#social-identity">Social Identity</a></h2>
<p>A social identity is an cryptographic keypair associated to represent a person or an organization.</p>
<p>The address of a social identity derived from the public key of a secp256k1 key using the same algorithm as Ethereum.
The address <strong>MAY</strong> also be called as &quot;Profile address&quot;.</p>
<h2 id="entities"><a class="header" href="#entities">Entities</a></h2>
<h3 id="profile"><a class="header" href="#profile">Profile</a></h3>
<p>Profile is a contract instance owned by a social identity.</p>
<p>A Profile <strong>MUST</strong> be able to prove the ownership of the social identity by providing the signature of <code>contract address + profile address</code>.</p>
<h3 id="resolver"><a class="header" href="#resolver">Resolver</a></h3>
<p>A Resolver is a contract instance which is able to resolve a Profile address to a Profile contract address.</p>
<p>A Resolver <strong>MUST</strong> validate the ownership of the Profile before updating the mapping.</p>
<h2 id="actions"><a class="header" href="#actions">Actions</a></h2>
<h3 id="follow"><a class="header" href="#follow">Follow</a></h3>
<p>Follow is an action to follow a Profile from a Profile.</p>
<ul>
<li>Target Profile <strong>MAY</strong> decide to accept or reject the follow request.</li>
<li>Target Profile <strong>MAY</strong> charge a fee for the follow request.</li>
<li>Target Profile <strong>MAY</strong> return some fee in the follow response.</li>
</ul>
<p>The action <strong>MUST</strong> emit an PendingFollowEvent from the target Profile if it returns a Pending.
The action <strong>MUST</strong> emit an NewFollowingEvent or FollowingRejectedEvent from the source Profile.
The action <strong>MUST</strong> emit an NewFollowerEvent from the target Profile if it accept the request.</p>
<h3 id="unfollow"><a class="header" href="#unfollow">Unfollow</a></h3>
<p>Unfollow is an action to unfollow a Profile from a Profile.</p>
<ul>
<li>Target Profile <strong>SHOULD</strong> handle the unfollow notification sent from the source Profile.</li>
<li>Source Profile <strong>MUST</strong> ignore any error occurs when sending unfollow notification.</li>
</ul>
<p>The action <strong>MUST</strong> emit an UnfollowEvent from the source Profile.</p>
<h3 id="post"><a class="header" href="#post">Post</a></h3>
<p>Post is an action of publishing a message from a Profile.</p>
<p>The Profile <strong>MUST</strong> provide valid signature in the PostEvent.</p>
<p>The action <strong>MUST</strong> emit an PostEvent.</p>
<h3 id="repost"><a class="header" href="#repost">Repost</a></h3>
<p>Repost is an action of publishing repost of another post from a Profile.</p>
<p>The Profile <strong>MUST</strong> provide valid signature in the PostEvent.</p>
<p>The action <strong>MUST</strong> emit an PostEvent.</p>
<h3 id="reply"><a class="header" href="#reply">Reply</a></h3>
<p>Reply is an action of publishing a reply to another post from a Profile.</p>
<ul>
<li>The Profile of the original post <strong>MAY</strong> reject the reply request by failing the action.</li>
<li>The Profile of the original post <strong>MAY</strong> increase the gas cost of the reply request.</li>
</ul>
<p>The action <strong>MUST</strong> emit an ReplyEvent in the Profile of the original post.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cryptography-design"><a class="header" href="#cryptography-design">Cryptography Design</a></h1>
<p>This project uses the secp256k1 curve, same curve as Ethereum.</p>
<p>A social identity is derived from the public key, using the same algorithm as Ethereum to calculate the address from the public key.</p>
<p>The secret key of it is a 32-bytes of random data which can also be derived from a mnemonic phrase (as described in BIP-39).
The key generation and management is not defined in this standards.
Implementations MAY choose different design.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="signature"><a class="header" href="#signature">Signature</a></h1>
<h2 id="generation"><a class="header" href="#generation">Generation</a></h2>
<p>Signature of a message is signed using <code>personal_sign</code> method of Ethereum RPC.
Implementations MUST sign the message in the same algorithm.</p>
<p>The process of signing a message can be described as:</p>
<pre><code>msgHash = keccak256(&quot;\x19Ethereum Signed Message:\n&quot; + msgLength + msg))
signature = ecSign(msgHash, privateKey, recovered = true)
</code></pre>
<h2 id="verification"><a class="header" href="#verification">Verification</a></h2>
<p>The verification of the signature can be done by using <code>ecRecover</code>.
Implementations MUST verify the signature in the same algorithm.</p>
<p>The process of signing a message can be described as:</p>
<pre><code>msgHash := keccak256(&quot;\x19Ethereum Signed Message:\n&quot; + msgLength + msg))
address = ecRecover(msgHash, signature)
assert(address == signer)
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="encryption"><a class="header" href="#encryption">Encryption</a></h1>
<h2 id="public-key-retrieval"><a class="header" href="#public-key-retrieval">Public Key Retrieval</a></h2>
<p>The public key of a social identity can be retrieved by using similar like <code>ecRecover</code> with the signature of a message.
<code>ecRecover</code> runs keccak256 on the public key to calculate the address.
Implementations MAY use library like <code>eth-crypto</code> to recover the public key from signature.</p>
<h2 id="encryption-scheme"><a class="header" href="#encryption-scheme">Encryption Scheme</a></h2>
<p>The encryption scheme is chosen to be ECIES on secp256k1.
Based on <a href="https://ecies.org/">ecies.org</a> implementation, the symmetric encryption algorithm is AES-256-GCM.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="message-format"><a class="header" href="#message-format">Message Format</a></h1>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </body>
</html>
